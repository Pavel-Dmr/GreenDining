<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ecom4.green.order.dao.OrdersDAO">
	<select id="getOrdersPage" parameterType="RequestPageList" resultType="ordersDTO">
		select *
		from orders
		<where>
			user_id = #{data.user_id}
		</where>
		OFFSET #{pageable.offset} ROWS FETCH NEXT #{pageable.pageSize} ROWS ONLY
	</select>
	
	<select id="getOrdersCount" parameterType="map" resultType="int">
		select count(*) as cnt
		from orders
		where user_id = #{map.user_id}
	</select>
	<select id="getOrderItemList" parameterType="int" resultType="orderItemDTO" >
		select *
		from order_item
		where order_id = #{order_id}
	</select>
	<select id="getOrderDetail" parameterType="int" resultType="ordersDTO">
		select *
		from orders
		<where>
			id = #{order_id}
		</where>
	</select>
	
	<select id="countInDelivery" resultType="int">
	    SELECT COUNT(*)
	    FROM orders
	    WHERE user_id = #{userId} AND status = '배송중'
	</select>
	
</mapper>